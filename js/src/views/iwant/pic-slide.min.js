define("jquery underscore backbone text!src/tpl/iwant/pic-slide.tpl ../../../libs/zepto/touch iscroll".split(" "),function(c,g,h,k){return h.View.extend({el:"body",template:g.template(k),myScroll:!1,events:{"tap .bg black":"close","tap .big_pic":"close","swipeLeft #slide-pic":"swipeLeft","swipeRight #slide-pic":"swipeRight"},close:function(){this.undelegateEvents();history.back()},swipeLeft:function(){var a=c("#slide-pic .center");if(!(0>=a.next().length)){this.myScroll.scrollTo(0,0);var b=a.next();
a.removeClass("center").addClass("left");b.removeClass("right").addClass("center");a=c(".dot .on");a.removeClass("on");a.next().addClass("on");this.loadImg(b)}},swipeRight:function(){var a=c("#slide-pic .center");if(!(0>=a.prev().length)){this.myScroll.scrollTo(0,0);var b=a.prev();a.removeClass("center").addClass("right");b.removeClass("left").addClass("center");a=c(".dot .on");a.removeClass("on");a.prev().addClass("on");this.loadImg(b)}},initialize:function(a){this.undelegateEvents();this.delegateEvents(this.events);
a.innerHeight=window.innerHeight;this.render(a)},render:function(a){c("body").append(this.template(a));this.loadImg();this.myScroll=new IScroll(".show_area",{scrollX:!1,scrollY:!0,useTransform:!1})},loadImg:function(a){var b=this;setTimeout(function(){var d=a?a.find("img"):c("#slide-pic .center img");if(d.hasClass("img_loaded"))b.refreshHeight(d);else{var e=d.attr("imgsrc"),f=new Image;f.onload=function(){f.onload=null;b.loadedimg(d)};f.src=e}},0)},loadedimg:function(a){var b=a.attr("imgsrc"),d=a.parent(),
e=document.createElement("img");e.src=b;e.setAttribute("class","img_loaded");d[0].appendChild(e);a.remove();var f=this;setTimeout(function(){f.refreshHeight(c(e))},100)},refreshHeight:function(a){c(".pic_wrap").height(a.height());this.myScroll?this.myScroll.refresh():this.myScroll=new IScroll(".show_area",{scrollX:!1,scrollY:!0,useTransform:!1})}})});
